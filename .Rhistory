#R tutorial BIP week
getwd()
getwd()
dir()
sessioninfo()
dir()
sessionInfo()
date()
Sys.time()
dir()
FirstVariable <- 1
FirstVariable
str(FirstVariable)
?str()
b <- "genomics"
c <- 23
d <- CDH1
d <- CDH1
d <-  "CDH1"
e <- “ftp://ftp.ensemblgenomes.org/pub/bacteria/release-39/fasta/bacteria_5_collection/escherichia_coli_b_str_rel606/”
f <- 46
e <- “ftp://ftp.ensemblgenomes.org/pub/bacteria/release-39/fasta/bacteria_5_collection/escherichia_coli_b_str_rel606/”
e <- ftp://ftp.ensemblgenomes.org/pub/bacteria/release-39/fasta/bacteria_5_collection/escherichia_coli_b_str_rel606/
e <- 'ftp://ftp.ensemblgenomes.org/pub/bacteria/release-39/fasta/bacteria_5_collection/escherichia_coli_b_str_rel606/'
rm(FirstVariable)
gene_name  <- "tp43"
gene_name <- "pten"
rm(gene_name)
pi <- 3.14
pi_name <- "pi"
pi_true <- TRUE
mode (pi_true)
chromosome_name <- "chr02"
od_600_value <- 0.47
chr_position <- '1001701'
spock <- TRUE
pilot <-  Earhart
pilot <-  Earhart
pilot <- "Earhart"
mode(chr02)
mode("chr02")
mode(od_600_value)
mode(pilot)
mode(spock)
mode(e)
(1 + (5 ** 0.5))/2
(1 + (od_600_value ** 0.5))/2
sqrt(625)
round(sqrt(666))
?round
round(sqrt(677,3))
round(sqrt(677):3)
round(8.8888, digits = 3)
round(((1+(sqrt(5)))/2), digits = 3)
snp_genes <- c("0XTR", "ACTN3", "AR", "0PRM1")
mode(snp_genes)
length(snp_genes)
str(snp_genes)
snps <- c('3', '11', 'X', '6')
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snp_genes[2:4]
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snp_genes[2:4]
snp_genes[3]
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snp_genes[2:4]
snp_genes[3]
snp_genes[c(1:2,4)]
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snp_genes[2:4]
snp_genes[3]
snp_genes[c(1:2,4)]
snp_genes[2]
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snp_genes[2:4]
snp_genes[3]
snp_genes[c(1:2,4)]
snp_genes[2]
subset_snp_genes <- snp_genes[c(1:2,4)]
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snp_genes[2:4]
snp_genes[3]
snp_genes[c(1:2,4)]
snp_genes[2]
subset_snp_genes <- snp_genes[c(1:2,4)]
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snp_genes[2:4]
snp_genes[3]
snp_genes[c(1:2,4)]
snp_genes[2]
subset_snp_genes <- snp_genes[c(1:2,4)]
snp_genes <- (c(snp_genes, "CYP1A1", "AP0A5"))
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snp_genes[2:4]
snp_genes[3]
snp_genes[c(1:2,4)]
snp_genes[2]
subset_snp_genes <- snp_genes[c(1:2,4)]
snp_genes <- (c(snp_genes, "CYP1A1", "AP0A5"))
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snp_genes[2:4]
snp_genes[3]
snp_genes[c(1:2,4)]
snp_genes[2]
subset_snp_genes <- snp_genes[c(1:2,4)]
snp_genes <- (c(snp_genes, "CYP1A1", "AP0A5"))
snp_genes[-5]
snps <- c('3', '11', 'X', '6
snp_positions <- c(8762685, 66560624, 67545785, 154039662)
snp_genes[3]
snp_genes[2:4]
snp_genes[3]
snp_genes[c(1:2,4)]
snp_genes[2]
subset_snp_genes <- snp_genes[c(1:2,4)]
snp_genes <- (c(snp_genes, "CYP1A1", "AP0A5"))
snp_genes[-5]
variants <- read.csv(file="combined_tidy_vcf.csv")
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
str(variants)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
str(variants)
variants$sample_id
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
str(variants)
variants$sample_id
variants <- read.csv(file= "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
str(variants)
variants$sample_id
variants <- read.csv(file= "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <-  read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors =T)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
str(variants)
variants$sample_id
variants <- read.csv(file= "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <-  read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors =T)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
str(variants)
variants$sample_id
variants <- read.csv(file= "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <-  read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
str(variants)
variants$sample_id
variants <- read.csv(file= "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <-  read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
str(variants)
variants$sample_id
variants <- read.csv(file= "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <-  read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
str(variants)
variants$sample_id
variants <- read.csv(file= "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <-  read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <- read.csv(file="combined_tidy_vcf.c
view(varaints)
View(variants)
summary(variants)
str(variants)
variants$sample_id
variants <- read.csv(file= "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <-  read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <- read.csv(file="combined_tidy_vcf.csv", stringsAsFactors = T)
variants$sample_id
variants <- read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors = T)
variants$sample_id
variants$sample_id
variants <- read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors = T)
variants$sample_id
variants <- read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors = T)
variants <- read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors = T)
variants$sample_id
variants$sample_id
variants$sample_id2 <- factor(x=variants$sample_id,
levels = c("SRR2584866", "SRR2584863", "SRR2589044"))
plot(variants$sample_id)
plot(variants$sample_id2)
variants$DP
variants <- read.csv(file = "combined_tidy_vcf.csv", stringsAsFactors = T)
variants$sample_id
SRR2584863_variants <-  variants[variants$sample_id == "SRR2584863",]
smp_chromoseomes <- c("3", "11", "x", "6")
typeof(smp_chromoseomes)
smp_chromoseomes[1]
as.numeric((smp_chromoseomes))
as.character(REF)
as.numeric(REF)
install.packages("dplyr")
#install.packages("dplyr")
library(dplyr)
select(variants, sample_id, REF, ALT, DP)
select(variants, -CHROM)
filter(variants, sample_id == "SRR2584863")
SRR2584863_variants <- filter(variants, sample_id == "SRR2584863")
SRR2584863_variants <- filter(variants, sample_id == "SRR2584863" )
variants %>%
variants %>%
select(REF, ALT, DP) %>%
filter(sample_id == "SRR2584863")
select(REF, ALT, DP) %>%
variants %>%
filter(sample_id == "SRR2584863") %>%
select(REF, ALT, DP)
variants %>%
filter(sample_id == "SRR2584863") %>%
select(REF, ALT, DP)
variants %>%
filter(sample_id == "SRR2584863") %>%
select(REF, ALT, DP)
variants %>%
filter(sample_id == "SRR2584863") %>%
select(REF, ALT, DP) %>%
glimpse()
variants %>%
filter(sample_id == "SRR2584863") %>%
select(REF, ALT, DP) %>%
variants %>%
filter(sample_id == "SRR2584863") %>%
select(REF, ALT, DP) %>%
variants %>%
filter(sample_id == "SRR2584863") %>%
select(REF, ALT, DP)
variants %>%
filter(sample_id == "SRR2584863") %>%
select(REF, ALT, DP)
head(SRR2584863_variants)
variants %>%
filter(sample_id =="SRR2484963",
DP > 10) %>%
select(REF, ALT, POS)
variants %>%
filter(sample_id =="SRR2484963",
DP > 10) %>%
select(REF, ALT, DP)
variants %>%
mutate(POLPROB = 1 - (10 ^ -(QUAL/10))) %>%
glimpse()
glimpse()
variants %>%
mutate(POLPROB = 1 - (10 ^ -(QUAL/10))) %>%
glimpse() %>%
select(sample_id, POS, QUAL, POLPROB)
variants %>%
group_by(sample_id) %>%
summarize(n())
sum.table <-  variants %>%
group_by(sample_id) %>%
summarize(n())
variants %>%
group_by(sample_id) %>%
summarize(max.dp = max(DP), )
variants %>%
group_by(sample_id) %>%
summarize(max.dp = max(DP),
total = n())
#START GGPLOT
install.packages("ggplot2")
library(ggplot2)
ggplot(data = variants)
ggplot(data = variants, mapping = aes(x = POS, y = DP))
ggplot(data = variants, mapping = aes(x = POS, y = DP))+
geom_point()
coverage_plot <- ggplot(data = variants, mapping = aes(x = POS, y = DP))
coverage_plot + geom_line()
coverage_plot + geom_point(size = 1)
coverage_plot + geom_point(size = .1)
coverage_plot + geom_point(alpha = 0.5)
coverage_plot + geom_point(alpha = 0.5, color = "blue")
coverage_plot + geom_point(alpha = 0.5, color = "yellow")
coverage_plot + geom_point(alpha = 0.5, color = "green")
coverage_plot + geom_point(alpha = 0.5, color = "dark green")
coverage_plot + geom_point(alpha = 0.5, color = "forest green")
coverage_plot + geom_jitter(alpha = 0.5)
coverage_plot + geom_jitter(alpha = 0.5)+
labs(x="Base Pair POsition",
y="Read Depth(DP)")
coverage_plot + geom_jitter(alpha = 0.5)+
labs(x="Base Pair Position",
y="Read Depth(DP)")
coverage_plot + geom_jitter(alpha = 0.5)+
labs(x="Base Pair Position",
y="Read Depth(DP)",
color="Sample ID")
ggplot(data = variants, aes(x = POS, y = DP, color = sample_id)) +
geom_point(alpha = 0.5)
ggplot(data = variants, aes(x = POS, y = MQ, color = sample_id)) +
geom_point() +
labs(x = "Base Pair Position",
y = "Mapping Quality (MQ)")
cover_plot + geom_jitter(alpha = 0.5)+
labs(x="base pair position",
y= "mapping quality",
color = "sample ID")+
facet_grid(.~sample_id~.)
coverage_plot + geom_jitter(alpha = 0.5)+
labs(x="base pair position",
y= "mapping quality",
color = "sample ID")+
facet_grid(.~sample_id~.)
coverage_plot + geom_jitter(alpha = 0.5)+
labs(x="base pair position",
y= "mapping quality",
color = "sample ID")+
facet_grid(.~sample_id~.)+
theme_bw()
coverage_plot + geom_jitter(alpha = 0.5)+
labs(x="base pair position",
y= "mapping quality",
color = "sample ID")+
facet_grid(.~sample_id~.)+
theme_bw()+
theme(panel.grid = elemenent_blank())
coverage_plot + geom_jitter(alpha = 0.5)+
labs(x="base pair position",
y= "mapping quality",
color = "sample ID")+
facet_grid(.~sample_id~.)+
theme_bw()+
theme(panel.grid = element_blank())
coverage_plot + geom_jitter(alpha = 0.5)+
labs(x="base pair position",
y= "mapping quality",
color = "sample ID")+
facet_grid(.~sample_id~.)+
theme_minimal()+
theme(panel.grid = element_blank())
coverage_plot + geom_jitter(alpha = 0.5)+
labs(x="base pair position",
y= "mapping quality",
color = "sample ID")+
facet_grid(.~sample_id~.)+
theme_dark()+
theme(panel.grid = element_blank())
ggplot(data=variants, maping=aes(x=POS, y=QUAL, color= sample_id))+
geom_point()+
labs(x="Base Pair Position",
y= "PHRED-Scale Quality")+
facet_grid(sample_id~.)
ggplot(data = variants, aes(x = POS, y = QUAL, color = sample_id)) +
geom_point() +
labs(x = "Base Pair Position",
y = "PHRED-sacled Quality (QUAL)") +
facet_grid(sample_id ~ .)
ggplot(data = variants, mapping = aes(x = INDEL), y = fill = sample_id))+
geom_bar()+
facet_grid(sample_id~.)
ggplot(data = variants, mapping = aes(x = INDEL, y = fill = sample_id)+
ggplot(data = variants, mapping = aes(x = INDEL, fill = sample_id)+
facet_grid(sample_id~.)
ggplot(data = variants, mapping = aes(x = INDEL, fill = sample_id)+
geom_bar()+
facet_grid(sample_id~.))
ggplot(data = variants, mapping = aes(x = INDEL, fill = sample_id)+
geom_bar()+
facet_grid(sample_id~.))
ggplot(data = variants, aes(x = INDEL, fill = sample_id)) +
geom_bar() +
facet_grid(sample_id ~ .)
?geom_bar
?geom_bar
ggplot(data = variants, aes(x = INDEL, fill = sample_id)) +
geom_bar(show.legend=FALSE) +
facet_grid(sample_id ~ .)
getwd()
setwd("~/Desktop/biocomp/RProject/Rproject2021"")
setwd("~/Desktop/biocomp/RProject/Rproject2021")
setwd("C:/Users/loand/Desktop/biocomp/RProject/Rproject2021")
> setwd("C:/Users/loand/Desktop/biocomp/RProject/Rproject2021")
> setwd("C:/Users/loand/Desktop/biocomp/RProject/Rproject2021")
getwd()
> setwd("C:/Users/loand/Desktop/biocomp/RProject/Rproject2021")
setwd("C:/Users/loand/Desktop/biocomp/RProject/Rproject2021")
